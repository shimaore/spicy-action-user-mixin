// Generated by CoffeeScript 1.12.5
(function() {
  var debug, user,
    hasProp = {}.hasOwnProperty;

  debug = (require('debug'))("spicy-action-user-mixin");

  user = {
    admin: false
  };

  module.exports = function() {
    return {
      init: function() {
        this.user = user;
        return this.on('mount', (function(_this) {
          return function() {
            return _this.ev.on('user-data', function() {
              return _this.update({
                user: user
              });
            });
          };
        })(this));
      },
      include: function(arg) {
        var ev;
        ev = arg.ev;
        ev.on('set-user-data', (function(_this) {
          return function(data) {
            var k, v;
            for (k in data) {
              if (!hasProp.call(data, k)) continue;
              v = data[k];
              user[k] = v;
            }
            return ev.trigger('user-data', user);
          };
        })(this));
        this.on('ready', function() {
          debug('received ready ← server', this.data);
          return ev.trigger('set-user-data', this.data);
        });
        ev.on('get-user-data', (function(_this) {
          return function() {
            debug('get-user-data: emit join → server');
            return _this.emit('join');
          };
        })(this));
        this.emit('join');
        return ev.on('set-user-param', (function(_this) {
          return function(name, value) {
            debug('set-user-param → server', name, value);
            return _this.emit('set_user_param', name, value);
          };
        })(this));
      }
    };
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC5jb2ZmZWUubWQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVJO0FBQUEsTUFBQSxXQUFBO0lBQUE7O0VBQUEsS0FBQSxHQUFRLENBQUMsT0FBQSxDQUFRLE9BQVIsQ0FBRCxDQUFBLENBQWtCLHlCQUFsQjs7RUFFUixJQUFBLEdBQU87SUFBQSxLQUFBLEVBQU8sS0FBUDs7O0VBRVAsTUFBTSxDQUFDLE9BQVAsR0FBaUIsU0FBQTtXQUNmO01BQUEsSUFBQSxFQUFNLFNBQUE7UUFFSixJQUFDLENBQUEsSUFBRCxHQUFRO2VBRVIsSUFBQyxDQUFBLEVBQUQsQ0FBSSxPQUFKLEVBQWEsQ0FBQSxTQUFBLEtBQUE7aUJBQUEsU0FBQTttQkFDWCxLQUFDLENBQUEsRUFBRSxDQUFDLEVBQUosQ0FBTyxXQUFQLEVBQW9CLFNBQUE7cUJBQ2xCLEtBQUMsQ0FBQSxNQUFELENBQVE7Z0JBQUMsTUFBQSxJQUFEO2VBQVI7WUFEa0IsQ0FBcEI7VUFEVztRQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBYjtNQUpJLENBQU47TUFRQSxPQUFBLEVBQVMsU0FBQyxHQUFEO0FBSVAsWUFBQTtRQUpTLEtBQUQ7UUFJUixFQUFFLENBQUMsRUFBSCxDQUFNLGVBQU4sRUFBdUIsQ0FBQSxTQUFBLEtBQUE7aUJBQUEsU0FBQyxJQUFEO0FBQ3JCLGdCQUFBO0FBQUEsaUJBQUEsU0FBQTs7O2NBQ0UsSUFBSyxDQUFBLENBQUEsQ0FBTCxHQUFVO0FBRFo7bUJBRUEsRUFBRSxDQUFDLE9BQUgsQ0FBVyxXQUFYLEVBQXdCLElBQXhCO1VBSHFCO1FBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUF2QjtRQU9BLElBQUMsQ0FBQSxFQUFELENBQUksT0FBSixFQUFhLFNBQUE7VUFDWCxLQUFBLENBQU0seUJBQU4sRUFBaUMsSUFBQyxDQUFBLElBQWxDO2lCQUNBLEVBQUUsQ0FBQyxPQUFILENBQVcsZUFBWCxFQUE0QixJQUFDLENBQUEsSUFBN0I7UUFGVyxDQUFiO1FBT0EsRUFBRSxDQUFDLEVBQUgsQ0FBTSxlQUFOLEVBQXVCLENBQUEsU0FBQSxLQUFBO2lCQUFBLFNBQUE7WUFDckIsS0FBQSxDQUFNLG1DQUFOO21CQUNBLEtBQUMsQ0FBQSxJQUFELENBQU0sTUFBTjtVQUZxQjtRQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBdkI7UUFJQSxJQUFDLENBQUEsSUFBRCxDQUFNLE1BQU47ZUFJQSxFQUFFLENBQUMsRUFBSCxDQUFNLGdCQUFOLEVBQXdCLENBQUEsU0FBQSxLQUFBO2lCQUFBLFNBQUMsSUFBRCxFQUFNLEtBQU47WUFDdEIsS0FBQSxDQUFNLHlCQUFOLEVBQWlDLElBQWpDLEVBQXVDLEtBQXZDO21CQUNBLEtBQUMsQ0FBQSxJQUFELENBQU0sZ0JBQU4sRUFBd0IsSUFBeEIsRUFBOEIsS0FBOUI7VUFGc0I7UUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQXhCO01BMUJPLENBUlQ7O0VBRGU7QUFKakIiLCJzb3VyY2VzQ29udGVudCI6WyJBIHJpZ2h0ZnVsLWhvdCBtaXhpbiBhbmQgc3RvcmUgdG8gc3VwcG9ydCBzcGljeS1hY3Rpb24tdXNlclxuXG4gICAgZGVidWcgPSAocmVxdWlyZSAnZGVidWcnKSBcInNwaWN5LWFjdGlvbi11c2VyLW1peGluXCJcblxuICAgIHVzZXIgPSBhZG1pbjogZmFsc2VcblxuICAgIG1vZHVsZS5leHBvcnRzID0gLT5cbiAgICAgIGluaXQ6IC0+XG5cbiAgICAgICAgQHVzZXIgPSB1c2VyXG5cbiAgICAgICAgQG9uICdtb3VudCcsID0+XG4gICAgICAgICAgQGV2Lm9uICd1c2VyLWRhdGEnLCA9PlxuICAgICAgICAgICAgQHVwZGF0ZSB7dXNlcn1cblxuICAgICAgaW5jbHVkZTogKHtldn0pIC0+XG5cblVzZWQgZm9yIHRlc3RpbmcuXG5cbiAgICAgICAgZXYub24gJ3NldC11c2VyLWRhdGEnLCAoZGF0YSkgPT5cbiAgICAgICAgICBmb3Igb3duIGssIHYgb2YgZGF0YVxuICAgICAgICAgICAgdXNlcltrXSA9IHZcbiAgICAgICAgICBldi50cmlnZ2VyICd1c2VyLWRhdGEnLCB1c2VyXG5cbk5vdGlmaWNhdGlvbiBmcm9tIHNlcnZlciB3aXRoIHVzZXItZGF0YS5cblxuICAgICAgICBAb24gJ3JlYWR5JywgLT5cbiAgICAgICAgICBkZWJ1ZyAncmVjZWl2ZWQgcmVhZHkg4oaQIHNlcnZlcicsIEBkYXRhXG4gICAgICAgICAgZXYudHJpZ2dlciAnc2V0LXVzZXItZGF0YScsIEBkYXRhXG5cbk9uIFphcHBhSlMtY2xpZW50IHJlYWR5IHdlIHNlbmQgYSBnZW5lcmljIGBzdWJzY3JpYmVgIG1lc3NhZ2UuXG5JbiByZXNwb25zZSwgdGhlIHNlcnZlciB3aWxsIGVtaXQgYHJlYWR5YC5cblxuICAgICAgICBldi5vbiAnZ2V0LXVzZXItZGF0YScsID0+XG4gICAgICAgICAgZGVidWcgJ2dldC11c2VyLWRhdGE6IGVtaXQgam9pbiDihpIgc2VydmVyJ1xuICAgICAgICAgIEBlbWl0ICdqb2luJ1xuXG4gICAgICAgIEBlbWl0ICdqb2luJ1xuXG5Ob3RpZmljYXRpb24gZnJvbSBjbGllbnQgd2l0aCB1c2VyIHBhcmFtZXRlci5cblxuICAgICAgICBldi5vbiAnc2V0LXVzZXItcGFyYW0nLCAobmFtZSx2YWx1ZSkgPT5cbiAgICAgICAgICBkZWJ1ZyAnc2V0LXVzZXItcGFyYW0g4oaSIHNlcnZlcicsIG5hbWUsIHZhbHVlXG4gICAgICAgICAgQGVtaXQgJ3NldF91c2VyX3BhcmFtJywgbmFtZSwgdmFsdWVcbiJdfQ==
//# sourceURL=/srv/home/stephane/Artisan/Managed/Telecoms/spicy-action-user-mixin/index.coffee.md